div.kanban-table.kanban-table-swimlane(
    ng-if="ctrl.initialLoad"
    tg-kanban-swimlane,
    tg-kanban-sortable,
    tg-kanban-squish-column,
    ng-class="{'zoom-0': ctrl.zoomLevel == 0}"
)
    div.kanban-table-header
        div.kanban-table-inner
            h2.task-colum-name(ng-repeat="s in usStatusList track by s.id",
                               tg-bo-title="s.name",
                               ng-class='{vfold:folds[s.id]}',
                               tg-class-permission="{'readonly': '!modify_task'}")
                div.deco-square(
                    ng-style="{'background-color':s.color}",
                    ng-class='{ hidden:folds[s.id] }'
                )
                div.title
                    div.name(tg-bo-bind="s.name")
                    div.counter(ng-if="!project.swimlines.length")
                        span {{ usByStatus.get(s.id.toString()).size || 0 }}
                        span(tg-bo-bind="' / ' + s.wip_limit", ng-if="s.wip_limit")
                div.options
                    a.option(
                        href=""
                        title="{{'KANBAN.TITLE_ACTION_ADD_US' | translate}}"
                        ng-click="ctrl.addNewUs('standard', s.id)"
                        tg-check-permission="add_us"
                        ng-hide="s.is_archived"
                    )
                        tg-svg.add-action(svg-icon="icon-add")

                    a.option(
                        href=""
                        title="{{'KANBAN.TITLE_ACTION_ADD_BULK' | translate}}"
                        ng-click="ctrl.addNewUs('bulk', s.id)"
                        tg-check-permission="add_us"
                        ng-hide="s.is_archived"
                    )
                        tg-svg.bulk-action(svg-icon="icon-bulk")
                    a.option(
                        href=""
                        ng-click='foldStatus(s)'
                        title="{{'KANBAN.TITLE_ACTION_FOLD' | translate}}"
                        ng-class='{hidden:folds[s.id]}'
                    )
                        tg-svg(svg-icon="icon-fold-column")

                    a.option.hunfold(
                        href=""
                        ng-click='foldStatus(s)'
                        title="{{'KANBAN.TITLE_ACTION_UNFOLD' | translate}}"
                        ng-class='{hidden:!folds[s.id]}'
                        ng-if="s.is_archived"
                        tg-kanban-archived-show-status-header="s"
                    )
                        tg-svg(svg-icon="icon-unfold-column")

                    a.option.hunfold(
                        href=""
                        ng-click='foldStatus(s)'
                        title="{{'KANBAN.TITLE_ACTION_UNFOLD' | translate}}"
                        ng-hide="s.is_archived"
                        ng-class='{hidden:!folds[s.id]}'
                    )
                        tg-svg(svg-icon="icon-unfold-column")
    div(
        ng-if="project.swimlanes.length"
        ng-repeat="swimline in project.swimlanes"
        data-swimline="{{swimline.id}}"
        class="kanban-swimline"
    )
        button.kanban-swimlane-title(
                ng-class="{folded: ctrl.foldedSwimlane[swimline.id]}"
                ng-click="ctrl.toggleSwimlane(swimline.id)"
            )
            tg-svg.unfold-action(
                ng-if="!ctrl.foldedSwimlane[swimline.id]"
                svg-icon="icon-unfolded-swimlane"
            )
            tg-svg.fold-action(
                ng-if="ctrl.foldedSwimlane[swimline.id]"
                svg-icon="icon-folded-swimlane"
            )
            h2.title-name  {{ swimline.name }}
        div.kanban-table-body(ng-if="!ctrl.foldedSwimlane[swimline.id]")
            div.kanban-table-inner
                div.kanban-uses-box.taskboard-column(
                    ng-class='{vfold:folds[s.id], vunfold: unfold == s.id}',
                    ng-repeat="s in ::usStatusList track by s.id",
                    id="column-{{s.id}}"
                    data-status-id="{{s.id}}"
                    data-swimline="{{swimline.id}}"
                    tg-kanban-swimlane-taskboard-column
                    tg-kanban-wip-limit="s",
                    tg-bind-scope
                )
                    div
                        .kanban-task-counter(ng-attr-title="{{'KANBAN.NUMBER_US' | translate}}") {{ usByStatusSwimlanes.getIn([swimline.id, s.id]).size }}
                        .placeholder-collapsed
                            .placeholder-collapsed-wrapper
                                div.ammount(ng-if="!s.is_archived")  {{ usByStatusSwimlanes.getIn([swimline.id, s.id]).size || 0 }}
                                div.text-holder
                                    div.archived(ng-if="s.is_archived") (Archived)
                                    div.name(tg-bo-bind="s.name")
                                .square-color(
                                    ng-style="{'background-color':s.color}",
                                )

                        .card-placeholder(
                            ng-if="ctrl.showPlaceHolder(s.id)"
                            ng-class='{"not-found": ctrl.notFoundUserstories}'
                            ng-include="'common/components/kanban-placeholder.html'"
                        )

                        tg-card.card.ng-animate-disabled(
                            tg-repeat="usId in usByStatusSwimlanes.getIn([swimline.id, s.id])",
                            ng-class="{'kanban-task-maximized': ctrl.isMaximized(s.id), 'kanban-task-minimized': ctrl.isMinimized(s.id), 'kanban-task-selected': ctrl.selectedUss[usId], 'ui-multisortable-multiple': ctrl.selectedUss[usId]}"
                            tg-class-permission="{'readonly': '!modify_task'}"
                            tg-bind-scope,
                            on-toggle-fold="ctrl.toggleFold(id)"
                            on-click-edit="ctrl.editUs(id)"
                            on-click-delete="ctrl.deleteUs(id)"
                            on-click-assigned-to="ctrl.changeUsAssignedUsers(id)"
                            project="project"
                            item="usMap.get(usId)"
                            type="us"
                            zoom="ctrl.zoom"
                            zoom-level="ctrl.zoomLevel"
                            archived="ctrl.isUsInArchivedHiddenStatus(usId)"
                            ng-click="($event.ctrlKey || $event.metaKey) && ctrl.toggleSelectedUs(usId)"
                        )

                        div.kanban-column-intro(
                            ng-if="s.is_archived",
                            tg-kanban-archived-status-intro="s"
                        )

    div(ng-if="!project.swimlanes.length")
        div.kanban-table-body
            div.kanban-table-inner
                div.kanban-uses-box.taskboard-column(
                    ng-class='{vfold:folds[s.id], vunfold: unfold == s.id}',
                    ng-repeat="s in ::usStatusList track by s.id",
                    id="column-{{s.id}}"
                    data-status-id="{{s.id}}"
                    tg-kanban-wip-limit="s",
                    tg-bind-scope
                )
                    div
                        .placeholder-collapsed
                            .placeholder-collapsed-wrapper
                                div.ammount(ng-if="!s.is_archived")  {{ usByStatus.get(s.id.toString()).size || 0 }}
                                div.text-holder
                                    div.archived(ng-if="s.is_archived") (Archived)
                                    div.name(tg-bo-bind="s.name")
                                .square-color(
                                    ng-style="{'background-color':s.color}",
                                )

                        .card-placeholder(
                            ng-if="ctrl.showPlaceHolder(s.id)"
                            ng-class='{"not-found": ctrl.notFoundUserstories}'
                            ng-include="'common/components/kanban-placeholder.html'"
                        )

                        tg-card.card.ng-animate-disabled(
                            tg-repeat="usId in usStatusList.get(s.id)",
                            ng-class="{'kanban-task-maximized': ctrl.isMaximized(s.id), 'kanban-task-minimized': ctrl.isMinimized(s.id), 'kanban-task-selected': ctrl.selectedUss[usId], 'ui-multisortable-multiple': ctrl.selectedUss[usId]}"
                            tg-class-permission="{'readonly': '!modify_task'}"
                            tg-bind-scope,
                            on-toggle-fold="ctrl.toggleFold(id)"
                            on-click-edit="ctrl.editUs(id)"
                            on-click-delete="ctrl.deleteUs(id)"
                            on-click-assigned-to="ctrl.changeUsAssignedUsers(id)"
                            project="project"
                            item="usMap.get(usId)"
                            type="us"
                            zoom="ctrl.zoom"
                            zoom-level="ctrl.zoomLevel"
                            archived="ctrl.isUsInArchivedHiddenStatus(usId)"
                            ng-click="($event.ctrlKey || $event.metaKey) && ctrl.toggleSelectedUs(usId)"
                        )

                        div.kanban-column-intro(
                            ng-if="s.is_archived",
                            tg-kanban-archived-status-intro="s"
                        )
